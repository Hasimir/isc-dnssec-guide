<section id="recipes-nsec3">
 <title>NSEC, NSEC3, and Unsiging</title>
 <section id="recipes-nsec-to-nsec3">
  <title>Migrating from NSEC to NSEC3</title>
  <para>This recipe describes how to go from using NSEC to NSEC3 for proof of
  non-existence, as described in both <xref linkend="signing-using-nsec3" />
  and <xref linkend="advanced-discussions-proof-of-nonexistence" />.</para>

  <para>This command below enables NSEC3 for the zone example.com, using a
  pseudo-random hex string 1234567890abcdef:</para>

  <screen># <userinput>rndc signing -nsec3param 1 0 10 1234567890abcdef example.com</userinput></screen>

  <para>You’ll know it worked if you see the following syslog messages:</para>

  <screen>Oct 21 13:47:21 received control channel command 'signing -nsec3param 1 0 10 1234567890abcdef example.com'
Oct 21 13:47:21 zone example.com/IN (signed): zone_addnsec3chain(1,CREATE,10,1234567890ABCDEF)</screen>

  <para>You can also verify that this worked by querying for a name you know
  that does not exist, and check for the presence of the NSEC3 record, such as
  this:</para>

  <screen>$ <userinput>dig @192.168.1.13 thereisnowaythisexists.example.com. A +dnssec +multiline</userinput>

...
TOM10UQBL336NFAQB3P6MOO53LSVG8UI.example.com. 300 IN <userinput>NSEC3</userinput> 1 0 10 1234567890ABCDEF (
				TQ9QBEGA6CROHEOC8KIH1A2C06IVQ5ER
				NS SOA RRSIG DNSKEY NSEC3PARAM )
...</screen>

  <para>Our example used four parameters: 1, 0, 10, and 1234567890ABCDEF, in
  the order they appeared. 1 represents the algorithm, 0 represents the opt-out
  flag, 10 represents the number of iterations, and 1234567890abcedf is the
  salt. To learn more about each of these parameters, please see <xref
  linkend="advanced-discussions-nsec3param" />.</para>

  <para>For example, to create an NSEC3 chain using the SHA-1 hash algorithm,
  no opt-out flag, 10 iterations, and a salt value of ”FFFF”, use: </para>

  <screen># <userinput>rndc signing -nsec3param 1 0 10 FFFF example.com</userinput></screen>

  <para>To set the opt-out flag, 15 iterations, and no salt, use:</para>

  <screen># <userinput>rndc signing -nsec3param 1 1 15 - example.com</userinput></screen>

 </section>
</section>
